<% require 'securerandom' %>
<% uid = SecureRandom.uuid %>
<% 

modal_uid = 'image-modal-' + uid 
# join_table = "#{field.resource.class.name.downcase}_images".to_sym
# join_symbol = "#{field.resource.class.name.downcase}_id".to_sym
# join_id = field.resource.id

%>

<%= render partial: "layouts/fields/modal", locals: { input_type: "radio", field_name: @field_name || :image_id, modal_uid: modal_uid, parent_selector:  '.field-unit--many-media-field', selected_image_id: nil } %>

<div class="field-unit__label">
  <%= f.label field.attribute %>
</div>
<div class="field-unit__field">
  <%= f.collection_select field.options[:foreign_key] ? field.options[:foreign_key] : :image_id,
    Image.all, 
    :id, 
    :name, 
    { include_blank: true } %>

  <div class="one_image_field">
  	<div class="row">   
    	<div class="col-sm-12">

          <%= link_to( '#', class: "remove-image btn btn-sm btn-primary" ) do %>
            <i class="fas fa-minus"></i> Remove Image
          <% end %>

          <%= link_to( dashboard_images_path( input_type: "radio", selected_image_id: field.data&.id, first_load: true, listing_id: false, field_name: field.name, modal_uid: modal_uid, parent_selector: '.field-unit--one-image-field' ), remote: true, data: { toggle: "modal", target: '#' + modal_uid }, class: "add-image btn btn-sm btn-primary") do %>
            <i class="fas fa-plus"></i> Add Image
          <% end %>
    	</div>
  	</div>

    <div class="new-listing-images">
      <div class="listing-images">
        <%= render partial: "layouts/fields/thumbnail_img", locals: { image: field.data } %>
      </div>
    </div>
  </div>

</div>
